var Pe=Object.create,U=Object.defineProperty,He=Object.getPrototypeOf,Ie=Object.prototype.hasOwnProperty,Re=Object.getOwnPropertyNames,Me=Object.getOwnPropertyDescriptor;var Le=i=>U(i,"__esModule",{value:!0});var y=(i,e)=>()=>(e||(e={exports:{}},i(e.exports,e)),e.exports);var je=(i,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Re(e))!Ie.call(i,n)&&n!=="default"&&U(i,n,{get:()=>e[n],enumerable:!(t=Me(e,n))||t.enumerable});return i},S=i=>i&&i.__esModule?i:je(Le(U(i!=null?Pe(He(i)):{},"default",{value:i,enumerable:!0})),i);var ue=y((v,se)=>{var qe=require("events").EventEmitter,W=require("child_process"),F=require("path"),Y=require("fs"),z=class{constructor(){this.helpWidth=void 0,this.sortSubcommands=!1,this.sortOptions=!1}visibleCommands(e){let t=e.commands.filter(n=>!n._hidden);if(e._hasImplicitHelpCommand()){let n=e._helpCommandnameAndArgs.split(/ +/),r=e.createCommand(n.shift()).helpOption(!1);r.description(e._helpCommandDescription),r._parseExpectedArgs(n),t.push(r)}return this.sortSubcommands&&t.sort((n,r)=>n.name().localeCompare(r.name())),t}visibleOptions(e){let t=e.options.filter(s=>!s.hidden),n=e._hasHelpOption&&e._helpShortFlag&&!e._findOption(e._helpShortFlag),r=e._hasHelpOption&&!e._findOption(e._helpLongFlag);if(n||r){let s;n?r?s=e.createOption(e._helpFlags,e._helpDescription):s=e.createOption(e._helpShortFlag,e._helpDescription):s=e.createOption(e._helpLongFlag,e._helpDescription),t.push(s)}if(this.sortOptions){let s=a=>a.short?a.short.replace(/^-/,""):a.long.replace(/^--/,"");t.sort((a,o)=>s(a).localeCompare(s(o)))}return t}visibleArguments(e){return e._argsDescription&&e._args.length?e._args.map(t=>({term:t.name,description:e._argsDescription[t.name]||""}),0):[]}subcommandTerm(e){let t=e._args.map(n=>oe(n)).join(" ");return e._name+(e._aliases[0]?"|"+e._aliases[0]:"")+(e.options.length?" [options]":"")+(t?" "+t:"")}optionTerm(e){return e.flags}longestSubcommandTermLength(e,t){return t.visibleCommands(e).reduce((n,r)=>Math.max(n,t.subcommandTerm(r).length),0)}longestOptionTermLength(e,t){return t.visibleOptions(e).reduce((n,r)=>Math.max(n,t.optionTerm(r).length),0)}longestArgumentTermLength(e,t){return t.visibleArguments(e).reduce((n,r)=>Math.max(n,r.term.length),0)}commandUsage(e){let t=e._name;e._aliases[0]&&(t=t+"|"+e._aliases[0]);let n="";for(let r=e.parent;r;r=r.parent)n=r.name()+" "+n;return n+t+" "+e.usage()}commandDescription(e){return e.description()}subcommandDescription(e){return e.description()}optionDescription(e){if(e.negate)return e.description;let t=[];return e.argChoices&&t.push(`choices: ${e.argChoices.map(n=>JSON.stringify(n)).join(", ")}`),e.defaultValue!==void 0&&t.push(`default: ${e.defaultValueDescription||JSON.stringify(e.defaultValue)}`),t.length>0?`${e.description} (${t.join(", ")})`:e.description}formatHelp(e,t){let n=t.padWidth(e,t),r=t.helpWidth||80,s=2,a=2;function o(h,C){if(C){let w=`${h.padEnd(n+a)}${C}`;return t.wrap(w,r-s,n+a)}return h}function c(h){return h.join(`
`).replace(/^/gm," ".repeat(s))}let u=[`Usage: ${t.commandUsage(e)}`,""],l=t.commandDescription(e);l.length>0&&(u=u.concat([l,""]));let p=t.visibleArguments(e).map(h=>o(h.term,h.description));p.length>0&&(u=u.concat(["Arguments:",c(p),""]));let m=t.visibleOptions(e).map(h=>o(t.optionTerm(h),t.optionDescription(h)));m.length>0&&(u=u.concat(["Options:",c(m),""]));let d=t.visibleCommands(e).map(h=>o(t.subcommandTerm(h),t.subcommandDescription(h)));return d.length>0&&(u=u.concat(["Commands:",c(d),""])),u.join(`
`)}padWidth(e,t){return Math.max(t.longestOptionTermLength(e,t),t.longestSubcommandTermLength(e,t),t.longestArgumentTermLength(e,t))}wrap(e,t,n,r=40){if(e.match(/[\n]\s+/))return e;let s=t-n;if(s<r)return e;let a=e.substr(0,n),o=e.substr(n),c=" ".repeat(n),u=new RegExp(".{1,"+(s-1)+"}([\\s\u200B]|$)|[^\\s\u200B]+?([\\s\u200B]|$)","g"),l=o.match(u)||[];return a+l.map((p,m)=>(p.slice(-1)===`
`&&(p=p.slice(0,p.length-1)),(m>0?c:"")+p.trimRight())).join(`
`)}},J=class{constructor(e,t){this.flags=e,this.description=t||"",this.required=e.includes("<"),this.optional=e.includes("["),this.variadic=/\w\.\.\.[>\]]$/.test(e),this.mandatory=!1;let n=ae(e);this.short=n.shortFlag,this.long=n.longFlag,this.negate=!1,this.long&&(this.negate=this.long.startsWith("--no-")),this.defaultValue=void 0,this.defaultValueDescription=void 0,this.parseArg=void 0,this.hidden=!1,this.argChoices=void 0}default(e,t){return this.defaultValue=e,this.defaultValueDescription=t,this}argParser(e){return this.parseArg=e,this}makeOptionMandatory(e=!0){return this.mandatory=!!e,this}hideHelp(e=!0){return this.hidden=!!e,this}choices(e){return this.argChoices=e,this.parseArg=t=>{if(!e.includes(t))throw new K(`Allowed choices are ${e.join(", ")}.`);return t},this}name(){return this.long?this.long.replace(/^--/,""):this.short.replace(/^-/,"")}attributeName(){return Be(this.name().replace(/^no-/,""))}is(e){return this.short===e||this.long===e}},x=class extends Error{constructor(e,t,n){super(n);Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.code=t,this.exitCode=e,this.nestedError=void 0}},K=class extends x{constructor(e){super(1,"commander.invalidOptionArgument",e);Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}},$=class extends qe{constructor(e){super();this.commands=[],this.options=[],this.parent=null,this._allowUnknownOption=!1,this._allowExcessArguments=!0,this._args=[],this.rawArgs=null,this._scriptPath=null,this._name=e||"",this._optionValues={},this._storeOptionsAsProperties=!1,this._actionResults=[],this._actionHandler=null,this._executableHandler=!1,this._executableFile=null,this._defaultCommandName=null,this._exitCallback=null,this._aliases=[],this._combineFlagAndOptionalValue=!0,this._description="",this._argsDescription=void 0,this._enablePositionalOptions=!1,this._passThroughOptions=!1,this._outputConfiguration={writeOut:t=>process.stdout.write(t),writeErr:t=>process.stderr.write(t),getOutHelpWidth:()=>process.stdout.isTTY?process.stdout.columns:void 0,getErrHelpWidth:()=>process.stderr.isTTY?process.stderr.columns:void 0,outputError:(t,n)=>n(t)},this._hidden=!1,this._hasHelpOption=!0,this._helpFlags="-h, --help",this._helpDescription="display help for command",this._helpShortFlag="-h",this._helpLongFlag="--help",this._addImplicitHelpCommand=void 0,this._helpCommandName="help",this._helpCommandnameAndArgs="help [command]",this._helpCommandDescription="display help for command",this._helpConfiguration={}}command(e,t,n){let r=t,s=n;typeof r=="object"&&r!==null&&(s=r,r=null),s=s||{};let a=e.split(/ +/),o=this.createCommand(a.shift());return r&&(o.description(r),o._executableHandler=!0),s.isDefault&&(this._defaultCommandName=o._name),o._outputConfiguration=this._outputConfiguration,o._hidden=!!(s.noHelp||s.hidden),o._hasHelpOption=this._hasHelpOption,o._helpFlags=this._helpFlags,o._helpDescription=this._helpDescription,o._helpShortFlag=this._helpShortFlag,o._helpLongFlag=this._helpLongFlag,o._helpCommandName=this._helpCommandName,o._helpCommandnameAndArgs=this._helpCommandnameAndArgs,o._helpCommandDescription=this._helpCommandDescription,o._helpConfiguration=this._helpConfiguration,o._exitCallback=this._exitCallback,o._storeOptionsAsProperties=this._storeOptionsAsProperties,o._combineFlagAndOptionalValue=this._combineFlagAndOptionalValue,o._allowExcessArguments=this._allowExcessArguments,o._enablePositionalOptions=this._enablePositionalOptions,o._executableFile=s.executableFile||null,this.commands.push(o),o._parseExpectedArgs(a),o.parent=this,r?this:o}createCommand(e){return new $(e)}createHelp(){return Object.assign(new z,this.configureHelp())}configureHelp(e){return e===void 0?this._helpConfiguration:(this._helpConfiguration=e,this)}configureOutput(e){return e===void 0?this._outputConfiguration:(Object.assign(this._outputConfiguration,e),this)}addCommand(e,t){if(!e._name)throw new Error("Command passed to .addCommand() must have a name");function n(r){r.forEach(s=>{if(s._executableHandler&&!s._executableFile)throw new Error(`Must specify executableFile for deeply nested executable: ${s.name()}`);n(s.commands)})}return n(e.commands),t=t||{},t.isDefault&&(this._defaultCommandName=e._name),(t.noHelp||t.hidden)&&(e._hidden=!0),this.commands.push(e),e.parent=this,this}arguments(e){return this._parseExpectedArgs(e.split(/ +/))}addHelpCommand(e,t){return e===!1?this._addImplicitHelpCommand=!1:(this._addImplicitHelpCommand=!0,typeof e=="string"&&(this._helpCommandName=e.split(" ")[0],this._helpCommandnameAndArgs=e),this._helpCommandDescription=t||this._helpCommandDescription),this}_hasImplicitHelpCommand(){return this._addImplicitHelpCommand===void 0?this.commands.length&&!this._actionHandler&&!this._findCommand("help"):this._addImplicitHelpCommand}_parseExpectedArgs(e){if(!!e.length)return e.forEach(t=>{let n={required:!1,name:"",variadic:!1};switch(t[0]){case"<":n.required=!0,n.name=t.slice(1,-1);break;case"[":n.name=t.slice(1,-1);break}n.name.length>3&&n.name.slice(-3)==="..."&&(n.variadic=!0,n.name=n.name.slice(0,-3)),n.name&&this._args.push(n)}),this._args.forEach((t,n)=>{if(t.variadic&&n<this._args.length-1)throw new Error(`only the last argument can be variadic '${t.name}'`)}),this}exitOverride(e){return e?this._exitCallback=e:this._exitCallback=t=>{if(t.code!=="commander.executeSubCommandAsync")throw t},this}_exit(e,t,n){this._exitCallback&&this._exitCallback(new x(e,t,n)),process.exit(e)}action(e){let t=n=>{let r=this._args.length,s=n.slice(0,r);this._storeOptionsAsProperties?s[r]=this:s[r]=this.opts(),s.push(this);let a=e.apply(this,s),o=this;for(;o.parent;)o=o.parent;o._actionResults.push(a)};return this._actionHandler=t,this}createOption(e,t){return new J(e,t)}addOption(e){let t=e.name(),n=e.attributeName(),r=e.defaultValue;if(e.negate||e.optional||e.required||typeof r=="boolean"){if(e.negate){let s=e.long.replace(/^--no-/,"--");r=this._findOption(s)?this._getOptionValue(n):!0}r!==void 0&&this._setOptionValue(n,r)}return this.options.push(e),this.on("option:"+t,s=>{let a=this._getOptionValue(n);if(s!==null&&e.parseArg)try{s=e.parseArg(s,a===void 0?r:a)}catch(o){if(o.code==="commander.invalidOptionArgument"){let c=`error: option '${e.flags}' argument '${s}' is invalid. ${o.message}`;this._displayError(o.exitCode,o.code,c)}throw o}else s!==null&&e.variadic&&(a===r||!Array.isArray(a)?s=[s]:s=a.concat(s));typeof a=="boolean"||typeof a=="undefined"?s==null?this._setOptionValue(n,e.negate?!1:r||!0):this._setOptionValue(n,s):s!==null&&this._setOptionValue(n,e.negate?!1:s)}),this}_optionEx(e,t,n,r,s){let a=this.createOption(t,n);if(a.makeOptionMandatory(!!e.mandatory),typeof r=="function")a.default(s).argParser(r);else if(r instanceof RegExp){let o=r;r=(c,u)=>{let l=o.exec(c);return l?l[0]:u},a.default(s).argParser(r)}else a.default(r);return this.addOption(a)}option(e,t,n,r){return this._optionEx({},e,t,n,r)}requiredOption(e,t,n,r){return this._optionEx({mandatory:!0},e,t,n,r)}combineFlagAndOptionalValue(e=!0){return this._combineFlagAndOptionalValue=!!e,this}allowUnknownOption(e=!0){return this._allowUnknownOption=!!e,this}allowExcessArguments(e=!0){return this._allowExcessArguments=!!e,this}enablePositionalOptions(e=!0){return this._enablePositionalOptions=!!e,this}passThroughOptions(e=!0){if(this._passThroughOptions=!!e,!!this.parent&&e&&!this.parent._enablePositionalOptions)throw new Error("passThroughOptions can not be used without turning on enablePositionOptions for parent command(s)");return this}storeOptionsAsProperties(e=!0){if(this._storeOptionsAsProperties=!!e,this.options.length)throw new Error("call .storeOptionsAsProperties() before adding options");return this}_setOptionValue(e,t){this._storeOptionsAsProperties?this[e]=t:this._optionValues[e]=t}_getOptionValue(e){return this._storeOptionsAsProperties?this[e]:this._optionValues[e]}parse(e,t){if(e!==void 0&&!Array.isArray(e))throw new Error("first parameter to parse must be array or undefined");t=t||{},e===void 0&&(e=process.argv,process.versions&&process.versions.electron&&(t.from="electron")),this.rawArgs=e.slice();let n;switch(t.from){case void 0:case"node":this._scriptPath=e[1],n=e.slice(2);break;case"electron":process.defaultApp?(this._scriptPath=e[1],n=e.slice(2)):n=e.slice(1);break;case"user":n=e.slice(0);break;default:throw new Error(`unexpected parse option { from: '${t.from}' }`)}return!this._scriptPath&&process.mainModule&&(this._scriptPath=process.mainModule.filename),this._name=this._name||this._scriptPath&&F.basename(this._scriptPath,F.extname(this._scriptPath)),this._parseCommand([],n),this}parseAsync(e,t){return this.parse(e,t),Promise.all(this._actionResults).then(()=>this)}_executeSubCommand(e,t){t=t.slice();let n=!1,r=[".js",".ts",".tsx",".mjs"];this._checkForMissingMandatoryOptions();let s=this._scriptPath;!s&&process.mainModule&&(s=process.mainModule.filename);let a;try{let m=Y.realpathSync(s);a=F.dirname(m)}catch(m){a="."}let o=F.basename(s,F.extname(s))+"-"+e._name;e._executableFile&&(o=e._executableFile);let c=F.join(a,o);Y.existsSync(c)?o=c:r.forEach(m=>{Y.existsSync(`${c}${m}`)&&(o=`${c}${m}`)}),n=r.includes(F.extname(o));let u;process.platform!=="win32"?n?(t.unshift(o),t=ce(process.execArgv).concat(t),u=W.spawn(process.argv[0],t,{stdio:"inherit"})):u=W.spawn(o,t,{stdio:"inherit"}):(t.unshift(o),t=ce(process.execArgv).concat(t),u=W.spawn(process.execPath,t,{stdio:"inherit"})),["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach(m=>{process.on(m,()=>{u.killed===!1&&u.exitCode===null&&u.kill(m)})});let p=this._exitCallback;p?u.on("close",()=>{p(new x(process.exitCode||0,"commander.executeSubCommandAsync","(close)"))}):u.on("close",process.exit.bind(process)),u.on("error",m=>{if(m.code==="ENOENT"){let d=`'${o}' does not exist
 - if '${e._name}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead
 - if the default executable name is not suitable, use the executableFile option to supply a custom name`;throw new Error(d)}else if(m.code==="EACCES")throw new Error(`'${o}' not executable`);if(!p)process.exit(1);else{let d=new x(1,"commander.executeSubCommandAsync","(error)");d.nestedError=m,p(d)}}),this.runningCommand=u}_dispatchSubcommand(e,t,n){let r=this._findCommand(e);r||this.help({error:!0}),r._executableHandler?this._executeSubCommand(r,t.concat(n)):r._parseCommand(t,n)}_parseCommand(e,t){let n=this.parseOptions(t);if(e=e.concat(n.operands),t=n.unknown,this.args=e.concat(t),e&&this._findCommand(e[0]))this._dispatchSubcommand(e[0],e.slice(1),t);else if(this._hasImplicitHelpCommand()&&e[0]===this._helpCommandName)e.length===1?this.help():this._dispatchSubcommand(e[1],[],[this._helpLongFlag]);else if(this._defaultCommandName)le(this,t),this._dispatchSubcommand(this._defaultCommandName,e,t);else{this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName&&this.help({error:!0}),le(this,n.unknown),this._checkForMissingMandatoryOptions(),n.unknown.length>0&&this.unknownOption(n.unknown[0]);let r=`command:${this.name()}`;if(this._actionHandler){let s=this.args.slice();this._args.forEach((a,o)=>{a.required&&s[o]==null?this.missingArgument(a.name):a.variadic&&(s[o]=s.splice(o),s.length=Math.min(o+1,s.length))}),s.length>this._args.length&&this._excessArguments(s),this._actionHandler(s),this.parent&&this.parent.emit(r,e,t)}else this.parent&&this.parent.listenerCount(r)?this.parent.emit(r,e,t):e.length?this._findCommand("*")?this._dispatchSubcommand("*",e,t):this.listenerCount("command:*")?this.emit("command:*",e,t):this.commands.length&&this.unknownCommand():this.commands.length&&this.help({error:!0})}}_findCommand(e){if(!!e)return this.commands.find(t=>t._name===e||t._aliases.includes(e))}_findOption(e){return this.options.find(t=>t.is(e))}_checkForMissingMandatoryOptions(){for(let e=this;e;e=e.parent)e.options.forEach(t=>{t.mandatory&&e._getOptionValue(t.attributeName())===void 0&&e.missingMandatoryOptionValue(t)})}parseOptions(e){let t=[],n=[],r=t,s=e.slice();function a(c){return c.length>1&&c[0]==="-"}let o=null;for(;s.length;){let c=s.shift();if(c==="--"){r===n&&r.push(c),r.push(...s);break}if(o&&!a(c)){this.emit(`option:${o.name()}`,c);continue}if(o=null,a(c)){let u=this._findOption(c);if(u){if(u.required){let l=s.shift();l===void 0&&this.optionMissingArgument(u),this.emit(`option:${u.name()}`,l)}else if(u.optional){let l=null;s.length>0&&!a(s[0])&&(l=s.shift()),this.emit(`option:${u.name()}`,l)}else this.emit(`option:${u.name()}`);o=u.variadic?u:null;continue}}if(c.length>2&&c[0]==="-"&&c[1]!=="-"){let u=this._findOption(`-${c[1]}`);if(u){u.required||u.optional&&this._combineFlagAndOptionalValue?this.emit(`option:${u.name()}`,c.slice(2)):(this.emit(`option:${u.name()}`),s.unshift(`-${c.slice(2)}`));continue}}if(/^--[^=]+=/.test(c)){let u=c.indexOf("="),l=this._findOption(c.slice(0,u));if(l&&(l.required||l.optional)){this.emit(`option:${l.name()}`,c.slice(u+1));continue}}if(a(c)&&(r=n),(this._enablePositionalOptions||this._passThroughOptions)&&t.length===0&&n.length===0){if(this._findCommand(c)){t.push(c),s.length>0&&n.push(...s);break}else if(c===this._helpCommandName&&this._hasImplicitHelpCommand()){t.push(c),s.length>0&&t.push(...s);break}else if(this._defaultCommandName){n.push(c),s.length>0&&n.push(...s);break}}if(this._passThroughOptions){r.push(c),s.length>0&&r.push(...s);break}r.push(c)}return{operands:t,unknown:n}}opts(){if(this._storeOptionsAsProperties){let e={},t=this.options.length;for(let n=0;n<t;n++){let r=this.options[n].attributeName();e[r]=r===this._versionOptionName?this._version:this[r]}return e}return this._optionValues}_displayError(e,t,n){this._outputConfiguration.outputError(`${n}
`,this._outputConfiguration.writeErr),this._exit(e,t,n)}missingArgument(e){let t=`error: missing required argument '${e}'`;this._displayError(1,"commander.missingArgument",t)}optionMissingArgument(e){let t=`error: option '${e.flags}' argument missing`;this._displayError(1,"commander.optionMissingArgument",t)}missingMandatoryOptionValue(e){let t=`error: required option '${e.flags}' not specified`;this._displayError(1,"commander.missingMandatoryOptionValue",t)}unknownOption(e){if(this._allowUnknownOption)return;let t=`error: unknown option '${e}'`;this._displayError(1,"commander.unknownOption",t)}_excessArguments(e){if(this._allowExcessArguments)return;let t=this._args.length,n=t===1?"":"s",s=`error: too many arguments${this.parent?` for '${this.name()}'`:""}. Expected ${t} argument${n} but got ${e.length}.`;this._displayError(1,"commander.excessArguments",s)}unknownCommand(){let e=[this.name()];for(let r=this.parent;r;r=r.parent)e.unshift(r.name());let t=e.join(" "),n=`error: unknown command '${this.args[0]}'.`+(this._hasHelpOption?` See '${t} ${this._helpLongFlag}'.`:"");this._displayError(1,"commander.unknownCommand",n)}version(e,t,n){if(e===void 0)return this._version;this._version=e,t=t||"-V, --version",n=n||"output the version number";let r=this.createOption(t,n);return this._versionOptionName=r.attributeName(),this.options.push(r),this.on("option:"+r.name(),()=>{this._outputConfiguration.writeOut(`${e}
`),this._exit(0,"commander.version",e)}),this}description(e,t){return e===void 0&&t===void 0?this._description:(this._description=e,this._argsDescription=t,this)}alias(e){if(e===void 0)return this._aliases[0];let t=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler&&(t=this.commands[this.commands.length-1]),e===t._name)throw new Error("Command alias can't be the same as its name");return t._aliases.push(e),this}aliases(e){return e===void 0?this._aliases:(e.forEach(t=>this.alias(t)),this)}usage(e){if(e===void 0){if(this._usage)return this._usage;let t=this._args.map(n=>oe(n));return[].concat(this.options.length||this._hasHelpOption?"[options]":[],this.commands.length?"[command]":[],this._args.length?t:[]).join(" ")}return this._usage=e,this}name(e){return e===void 0?this._name:(this._name=e,this)}helpInformation(e){let t=this.createHelp();return t.helpWidth===void 0&&(t.helpWidth=e&&e.error?this._outputConfiguration.getErrHelpWidth():this._outputConfiguration.getOutHelpWidth()),t.formatHelp(this,t)}_getHelpContext(e){e=e||{};let t={error:!!e.error},n;return t.error?n=r=>this._outputConfiguration.writeErr(r):n=r=>this._outputConfiguration.writeOut(r),t.write=e.write||n,t.command=this,t}outputHelp(e){let t;typeof e=="function"&&(t=e,e=void 0);let n=this._getHelpContext(e),r=[],s=this;for(;s;)r.push(s),s=s.parent;r.slice().reverse().forEach(o=>o.emit("beforeAllHelp",n)),this.emit("beforeHelp",n);let a=this.helpInformation(n);if(t&&(a=t(a),typeof a!="string"&&!Buffer.isBuffer(a)))throw new Error("outputHelp callback must return a string or a Buffer");n.write(a),this.emit(this._helpLongFlag),this.emit("afterHelp",n),r.forEach(o=>o.emit("afterAllHelp",n))}helpOption(e,t){if(typeof e=="boolean")return this._hasHelpOption=e,this;this._helpFlags=e||this._helpFlags,this._helpDescription=t||this._helpDescription;let n=ae(this._helpFlags);return this._helpShortFlag=n.shortFlag,this._helpLongFlag=n.longFlag,this}help(e){this.outputHelp(e);let t=process.exitCode||0;t===0&&e&&typeof e!="function"&&e.error&&(t=1),this._exit(t,"commander.help","(outputHelp)")}addHelpText(e,t){let n=["beforeAll","before","after","afterAll"];if(!n.includes(e))throw new Error(`Unexpected value for position to addHelpText.
Expecting one of '${n.join("', '")}'`);let r=`${e}Help`;return this.on(r,s=>{let a;typeof t=="function"?a=t({error:s.error,command:s.command}):a=t,a&&s.write(`${a}
`)}),this}};v=se.exports=new $;v.program=v;v.Command=$;v.Option=J;v.CommanderError=x;v.InvalidOptionArgumentError=K;v.Help=z;function Be(i){return i.split("-").reduce((e,t)=>e+t[0].toUpperCase()+t.slice(1))}function le(i,e){i._hasHelpOption&&e.find(n=>n===i._helpLongFlag||n===i._helpShortFlag)&&(i.outputHelp(),i._exit(0,"commander.helpDisplayed","(outputHelp)"))}function oe(i){let e=i.name+(i.variadic===!0?"...":"");return i.required?"<"+e+">":"["+e+"]"}function ae(i){let e,t,n=i.split(/[ |,]+/);return n.length>1&&!/^[[<]/.test(n[1])&&(e=n.shift()),t=n.shift(),!e&&/^-[^-]$/.test(t)&&(e=t,t=void 0),{shortFlag:e,longFlag:t}}function ce(i){return i.map(e=>{if(!e.startsWith("--inspect"))return e;let t,n="127.0.0.1",r="9229",s;return(s=e.match(/^(--inspect(-brk)?)$/))!==null?t=s[1]:(s=e.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null?(t=s[1],/^\d+$/.test(s[3])?r=s[3]:n=s[3]):(s=e.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null&&(t=s[1],n=s[3],r=s[4]),t&&r!=="0"?`${t}=${n}:${parseInt(r)+1}`:e})}});var me=y((Ct,pe)=>{pe.exports=function(i,e){if(e=e||{},i==null)return i;var t=e.width||50,n=typeof e.indent=="string"?e.indent:"  ",r=e.newline||`
`+n,s=typeof e.escape=="function"?e.escape:Ge,a=".{1,"+t+"}";e.cut!==!0&&(a+="([\\s\u200B]+|$)|[^\\s\u200B]+?([\\s\u200B]+|$)");var o=new RegExp(a,"g"),c=i.match(o)||[],u=n+c.map(function(l){return l.slice(-1)===`
`&&(l=l.slice(0,l.length-1)),s(l)}).join(r);return e.trim===!0&&(u=u.replace(/[ \t]*$/gm,"")),u};function Ge(i){return i}});var de=y((bt,he)=>{var E=1e3,N=E*60,V=N*60,A=V*24,Ue=A*7,We=A*365.25;he.exports=function(i,e){e=e||{};var t=typeof i;if(t==="string"&&i.length>0)return Ye(i);if(t==="number"&&isFinite(i))return e.long?Je(i):ze(i);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(i))};function Ye(i){if(i=String(i),!(i.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(i);if(!!e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*We;case"weeks":case"week":case"w":return t*Ue;case"days":case"day":case"d":return t*A;case"hours":case"hour":case"hrs":case"hr":case"h":return t*V;case"minutes":case"minute":case"mins":case"min":case"m":return t*N;case"seconds":case"second":case"secs":case"sec":case"s":return t*E;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function ze(i){var e=Math.abs(i);return e>=A?Math.round(i/A)+"d":e>=V?Math.round(i/V)+"h":e>=N?Math.round(i/N)+"m":e>=E?Math.round(i/E)+"s":i+"ms"}function Je(i){var e=Math.abs(i);return e>=A?H(i,e,A,"day"):e>=V?H(i,e,V,"hour"):e>=N?H(i,e,N,"minute"):e>=E?H(i,e,E,"second"):i+" ms"}function H(i,e,t,n){var r=e>=t*1.5;return Math.round(i/t)+" "+n+(r?"s":"")}});var Q=y((yt,fe)=>{function Ke(i){t.debug=t,t.default=t,t.coerce=c,t.disable=s,t.enable=r,t.enabled=a,t.humanize=de(),t.destroy=u,Object.keys(i).forEach(l=>{t[l]=i[l]}),t.names=[],t.skips=[],t.formatters={};function e(l){let p=0;for(let m=0;m<l.length;m++)p=(p<<5)-p+l.charCodeAt(m),p|=0;return t.colors[Math.abs(p)%t.colors.length]}t.selectColor=e;function t(l){let p,m=null;function d(...h){if(!d.enabled)return;let C=d,w=Number(new Date),B=w-(p||w);C.diff=B,C.prev=p,C.curr=w,p=w,h[0]=t.coerce(h[0]),typeof h[0]!="string"&&h.unshift("%O");let P=0;h[0]=h[0].replace(/%([a-zA-Z%])/g,(G,ke)=>{if(G==="%%")return"%";P++;let re=t.formatters[ke];if(typeof re=="function"){let Te=h[P];G=re.call(C,Te),h.splice(P,1),P--}return G}),t.formatArgs.call(C,h),(C.log||t.log).apply(C,h)}return d.namespace=l,d.useColors=t.useColors(),d.color=t.selectColor(l),d.extend=n,d.destroy=t.destroy,Object.defineProperty(d,"enabled",{enumerable:!0,configurable:!1,get:()=>m===null?t.enabled(l):m,set:h=>{m=h}}),typeof t.init=="function"&&t.init(d),d}function n(l,p){let m=t(this.namespace+(typeof p=="undefined"?":":p)+l);return m.log=this.log,m}function r(l){t.save(l),t.names=[],t.skips=[];let p,m=(typeof l=="string"?l:"").split(/[\s,]+/),d=m.length;for(p=0;p<d;p++)!m[p]||(l=m[p].replace(/\*/g,".*?"),l[0]==="-"?t.skips.push(new RegExp("^"+l.substr(1)+"$")):t.names.push(new RegExp("^"+l+"$")))}function s(){let l=[...t.names.map(o),...t.skips.map(o).map(p=>"-"+p)].join(",");return t.enable(""),l}function a(l){if(l[l.length-1]==="*")return!0;let p,m;for(p=0,m=t.skips.length;p<m;p++)if(t.skips[p].test(l))return!1;for(p=0,m=t.names.length;p<m;p++)if(t.names[p].test(l))return!0;return!1}function o(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function c(l){return l instanceof Error?l.stack||l.message:l}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}fe.exports=Ke});var ge=y((_,I)=>{_.formatArgs=Ze;_.save=Qe;_.load=Xe;_.useColors=et;_.storage=tt();_.destroy=(()=>{let i=!1;return()=>{i||(i=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();_.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function et(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Ze(i){if(i[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+i[0]+(this.useColors?"%c ":" ")+"+"+I.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;i.splice(1,0,e,"color: inherit");let t=0,n=0;i[0].replace(/%[a-zA-Z%]/g,r=>{r!=="%%"&&(t++,r==="%c"&&(n=t))}),i.splice(n,0,e)}_.log=console.debug||console.log||(()=>{});function Qe(i){try{i?_.storage.setItem("debug",i):_.storage.removeItem("debug")}catch(e){}}function Xe(){let i;try{i=_.storage.getItem("debug")}catch(e){}return!i&&typeof process!="undefined"&&"env"in process&&(i=process.env.DEBUG),i}function tt(){try{return localStorage}catch(i){}}I.exports=Q()(_);var{formatters:nt}=I.exports;nt.j=function(i){try{return JSON.stringify(i)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var Ce=y((vt,_e)=>{"use strict";_e.exports=(i,e=process.argv)=>{let t=i.startsWith("-")?"":i.length===1?"-":"--",n=e.indexOf(t+i),r=e.indexOf("--");return n!==-1&&(r===-1||n<r)}});var ve=y((wt,be)=>{"use strict";var it=require("os"),ye=require("tty"),b=Ce(),{env:f}=process,O;b("no-color")||b("no-colors")||b("color=false")||b("color=never")?O=0:(b("color")||b("colors")||b("color=true")||b("color=always"))&&(O=1);"FORCE_COLOR"in f&&(f.FORCE_COLOR==="true"?O=1:f.FORCE_COLOR==="false"?O=0:O=f.FORCE_COLOR.length===0?1:Math.min(parseInt(f.FORCE_COLOR,10),3));function X(i){return i===0?!1:{level:i,hasBasic:!0,has256:i>=2,has16m:i>=3}}function ee(i,e){if(O===0)return 0;if(b("color=16m")||b("color=full")||b("color=truecolor"))return 3;if(b("color=256"))return 2;if(i&&!e&&O===void 0)return 0;let t=O||0;if(f.TERM==="dumb")return t;if(process.platform==="win32"){let n=it.release().split(".");return Number(n[0])>=10&&Number(n[2])>=10586?Number(n[2])>=14931?3:2:1}if("CI"in f)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(n=>n in f)||f.CI_NAME==="codeship"?1:t;if("TEAMCITY_VERSION"in f)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(f.TEAMCITY_VERSION)?1:0;if(f.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in f){let n=parseInt((f.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(f.TERM_PROGRAM){case"iTerm.app":return n>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(f.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(f.TERM)||"COLORTERM"in f?1:t}function rt(i){let e=ee(i,i&&i.isTTY);return X(e)}be.exports={supportsColor:rt,stdout:X(ee(!0,ye.isatty(1))),stderr:X(ee(!0,ye.isatty(2)))}});var Oe=y((g,R)=>{var st=require("tty"),M=require("util");g.init=ot;g.log=at;g.formatArgs=lt;g.save=ct;g.load=ut;g.useColors=pt;g.destroy=M.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");g.colors=[6,2,3,4,5,1];try{let i=ve();i&&(i.stderr||i).level>=2&&(g.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(i){}g.inspectOpts=Object.keys(process.env).filter(i=>/^debug_/i.test(i)).reduce((i,e)=>{let t=e.substring(6).toLowerCase().replace(/_([a-z])/g,(r,s)=>s.toUpperCase()),n=process.env[e];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),i[t]=n,i},{});function pt(){return"colors"in g.inspectOpts?Boolean(g.inspectOpts.colors):st.isatty(process.stderr.fd)}function lt(i){let{namespace:e,useColors:t}=this;if(t){let n=this.color,r="[3"+(n<8?n:"8;5;"+n),s=`  ${r};1m${e} [0m`;i[0]=s+i[0].split(`
`).join(`
`+s),i.push(r+"m+"+R.exports.humanize(this.diff)+"[0m")}else i[0]=mt()+e+" "+i[0]}function mt(){return g.inspectOpts.hideDate?"":new Date().toISOString()+" "}function at(...i){return process.stderr.write(M.format(...i)+`
`)}function ct(i){i?process.env.DEBUG=i:delete process.env.DEBUG}function ut(){return process.env.DEBUG}function ot(i){i.inspectOpts={};let e=Object.keys(g.inspectOpts);for(let t=0;t<e.length;t++)i.inspectOpts[e[t]]=g.inspectOpts[e[t]]}R.exports=Q()(g);var{formatters:we}=R.exports;we.o=function(i){return this.inspectOpts.colors=this.useColors,M.inspect(i,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};we.O=function(i){return this.inspectOpts.colors=this.useColors,M.inspect(i,this.inspectOpts)}});var Fe=y((Ot,te)=>{typeof process=="undefined"||process.type==="renderer"||process.browser===!0||process.__nwjs?te.exports=ge():te.exports=Oe()});var T=S(ue());var Ae=S(require("fs/promises"));var Z=[{id:"AdSense",innerName:"Adsense_v1_4",abbreviatedName:"Adsense.V1_4.",url:"https://script.google.com/macros/autocomplete/dep/apiary/adsense/v1.4"},{id:"AdminDirectory",innerName:"Admin_directory_v1",abbreviatedName:"Admin.Directory_v1.",url:"https://script.google.com/macros/autocomplete/dep/apiary/admin/directory_v1"},{id:"AdminReports",innerName:"Admin_reports_v1",abbreviatedName:"Admin.Reports_v1.",url:"https://script.google.com/macros/autocomplete/dep/apiary/admin/reports_v1"},{id:"AnalyticsReporting",innerName:"Analyticsreporting_v4",abbreviatedName:"Analyticsreporting.V4.",url:"https://script.google.com/macros/autocomplete/dep/apiary/analyticsreporting/v4"},{id:"Area120Tables",innerName:"Area120tables_v1alpha1",abbreviatedName:"Area120tables.V1alpha1.",url:"https://script.google.com/macros/autocomplete/dep/apiary/area120tables/v1alpha1"},{id:"BigQuery",innerName:"Bigquery_v2",abbreviatedName:"Bigquery.V2.",url:"https://script.google.com/macros/autocomplete/dep/apiary/bigquery/v2"},{id:"Calendar",innerName:"Calendar_v3",abbreviatedName:"Calendar.V3.",url:"https://script.google.com/macros/autocomplete/dep/apiary/calendar/v3"},{id:"DoubleClickCampaigns",innerName:"Dfareporting_v3_4",abbreviatedName:"Dfareporting.V3_4.",url:"https://script.google.com/macros/autocomplete/dep/apiary/dfareporting/v3.4"},{id:"ShoppingContent",innerName:"Content_v2",abbreviatedName:"Content.V2.",url:"https://script.google.com/macros/autocomplete/dep/apiary/content/v2"},{id:"Drive",innerName:"Drive_v2",abbreviatedName:"Drive.V2.",url:"https://script.google.com/macros/autocomplete/dep/apiary/drive/v2"},{id:"DriveActivity",innerName:"Driveactivity_v2",abbreviatedName:"Driveactivity.V2.",url:"https://script.google.com/macros/autocomplete/dep/apiary/driveactivity/v2"},{id:"AdminLicenseManager",innerName:"Licensing_v1",abbreviatedName:"Licensing.V1.",url:"https://script.google.com/macros/autocomplete/dep/apiary/licensing/v1"},{id:"Gmail",innerName:"Gmail_v1",abbreviatedName:"Gmail.V1.",url:"https://script.google.com/macros/autocomplete/dep/apiary/gmail/v1"},{id:"Analytics",innerName:"Analytics_v3",abbreviatedName:"Analytics.V3.",url:"https://script.google.com/macros/autocomplete/dep/apiary/analytics/v3"},{id:"Classroom",innerName:"Classroom_v1",abbreviatedName:"Classroom.V1.",url:"https://script.google.com/macros/autocomplete/dep/apiary/classroom/v1"},{id:"Docs",innerName:"Docs_v1",abbreviatedName:"Docs.V1.",url:"https://script.google.com/macros/autocomplete/dep/apiary/docs/v1"},{id:"Sheets",innerName:"Sheets_v4",abbreviatedName:"Sheets.V4.",url:"https://script.google.com/macros/autocomplete/dep/apiary/sheets/v4"},{id:"Slides",innerName:"Slides_v1",abbreviatedName:"Slides.V1.",url:"https://script.google.com/macros/autocomplete/dep/apiary/slides/v1"},{id:"AdminReseller",innerName:"Reseller_v1",abbreviatedName:"Reseller.V1.",url:"https://script.google.com/macros/autocomplete/dep/apiary/reseller/v1"},{id:"AdminGroupsMigration",innerName:"Groupsmigration_v1",abbreviatedName:"Groupsmigration.V1.",url:"https://script.google.com/macros/autocomplete/dep/apiary/groupsmigration/v1"},{id:"AdminGroupsSettings",innerName:"Groupssettings_v1",abbreviatedName:"Groupssettings.V1.",url:"https://script.google.com/macros/autocomplete/dep/apiary/groupssettings/v1"},{id:"Mirror",innerName:"==== NOT FOUND ====",abbreviatedName:"==== NOT FOUND ====",url:"https://script.google.com/macros/autocomplete/dep/apiary/mirror/v1"},{id:"People",innerName:"Peopleapi_v1",abbreviatedName:"Peopleapi.V1.",url:"https://script.google.com/macros/autocomplete/dep/apiary/peopleapi/v1"},{id:"TagManager",innerName:"Tagmanager_v2",abbreviatedName:"Tagmanager.V2.",url:"https://script.google.com/macros/autocomplete/dep/apiary/tagmanager/v2"},{id:"Tasks",innerName:"Tasks_v1",abbreviatedName:"Tasks.V1.",url:"https://script.google.com/macros/autocomplete/dep/apiary/tasks/v1"},{id:"YouTubeAnalytics",innerName:"YoutubeAnalytics_v2",abbreviatedName:"YoutubeAnalytics.V2.",url:"https://script.google.com/macros/autocomplete/dep/apiary/youtubeAnalytics/v2"},{id:"YouTubeContentId",innerName:"YoutubePartner_v1",abbreviatedName:"YoutubePartner.V1.",url:"https://script.google.com/macros/autocomplete/dep/apiary/youtubePartner/v1"},{id:"YouTube",innerName:"Youtube_v3",abbreviatedName:"Youtube.V3.",url:"https://script.google.com/macros/autocomplete/dep/apiary/youtube/v3"}];var Se=S(me()),xe=S(Fe()),D=4,L=class{constructor(e){this.add=e=>{if(this.package.length+1===e.package.length)this.interfaces.push(e);else if(this.package.length+1<e.package.length){let t=e.package[this.package.length];xe.default(`[DEBUG] childName=${t}, fullname=${e.package.join(".")}, children = ${this.children.map(r=>r.name)}`);let n=this.children.find(r=>r.name===t);n||(n=new L([...this.package,t].join(".")),this.children.push(n)),n.add(e)}};this.toString=(e=0)=>{let t=e===0?"declare ":"";return t+=" ".repeat(D*e),t+="namespace "+this.name+` {
`,this.children.forEach(n=>{t+=n.toString(e+1)}),this.interfaces.forEach(n=>{t+=n.toString(e+1)}),t+=" ".repeat(D*e)+`}
`,t};this.package=e.split("."),this.children=[],this.interfaces=[]}get name(){return this.package[this.package.length-1]}},Ee=class{constructor(e,t,n,r){this.toString=(e=0)=>{let t=" ".repeat(D*e),n="";return this.comment&&(n+=this.comment.toString(e)),n+=t+"interface "+this.name+` {
`,this.fields.forEach(r=>{n+=r.toString(e+1)}),this.methods.forEach(r=>{n+=r.toString(e+1)}),n+=t+`}
`,n};this.package=e.split("."),this.fields=t,this.methods=n,this.comment=r}get name(){return this.package[this.package.length-1]}},Ne=class{constructor(e,t,n,r){this.toString=e=>{let t=" ".repeat(D*e),n="";return this.comment&&(n+=this.comment.toString(e)),n+=t+this.name+"(",n+=this.args.map(r=>`${r.name}: ${r.typeName}`).join(", "),n+=`): ${this.returnTypeName};
`,n};this.name=e,this.returnTypeName=t,this.args=n,this.comment=r}},ne=class{constructor(e,t,n){this.toString=e=>{let t=" ".repeat(D*e),n="";return this.comment&&(n+=this.comment.toString(e)),n+=t+this.name+"?: "+this.typeName+`;
`,n};this.name=e,this.typeName=t,this.comment=n}},k=class{constructor(e){this.toString=e=>Se.default(this.comment,{indent:"",width:120}).split(`
`).map(t=>(" ".repeat(D*e)+"// "+t).trimEnd()+`
`).join("");this.comment=e}},Ve=i=>i.replace(/(\w+)-(\w)(\w+)/,(e,t,n,r)=>t+n.toUpperCase()+r),ht={"Area120tables.V1alpha1.Schema.Empty":"any","Bigquery.V2.Schema.JsonObject":"any","Classroom.V1.Schema.Empty":"void","Classroom.V1.Schema.ReclaimStudentSubmissionRequest":"any","Classroom.V1.Schema.ReturnStudentSubmissionRequest":"any","Classroom.V1.Schema.TurnInStudentSubmissionRequest":"any","Docs.V1.Schema.EmbeddedDrawingProperties":"any","Docs.V1.Schema.EmbeddedDrawingPropertiesSuggestionState":"any","Driveactivity.V2.Schema.Administrator":"any","Driveactivity.V2.Schema.AnonymousUser":"any","Driveactivity.V2.Schema.Anyone":"any","Driveactivity.V2.Schema.DeletedUser":"any","Driveactivity.V2.Schema.DriveFile":"any","Driveactivity.V2.Schema.Edit":"any","Driveactivity.V2.Schema.File":"any","Driveactivity.V2.Schema.Legacy":"any","Driveactivity.V2.Schema.NoConsolidation":"any","Driveactivity.V2.Schema.New":"any","Driveactivity.V2.Schema.UnknownUser":"any","Driveactivity.V2.Schema.Upload":"any","Licensing.V1.Schema.Empty":"void","Peopleapi.V1.Schema.Empty":"void","Sheets.V4.Schema.ClearValuesRequest":"any","Youtube.V3.Schema.TokenPagination":"any","Youtube.V3.Schema.TestItemTestItemSnippet":"any","Youtube.V3.Schema.VideoProjectDetails":"any","YoutubePartner.V1.Schema.Empty":"void"},dt=(i,e)=>{for(let t of Z){if(i===t.innerName)return t.id;{let n=`${t.innerName}.${t.abbreviatedName}`;if(i.startsWith(n))return i.replace(n,e?"":t.id+".");if(i.startsWith(t.abbreviatedName))return i.replace(t.abbreviatedName,"")}}},j=(i,e)=>{if(i==="void"||i==="Integer"||i==="Integer[]"||i==="Byte[]")return i;if(i==="Number")return"number";if(i==="Number[]")return"number[]";if(i==="String")return"string";if(i==="String[]")return"string[]";if(i==="String[][]")return"string[][]";if(i==="Boolean")return"boolean";if(i==="Boolean[]")return"boolean[]";if(i==="Object")return"object";if(i==="Object[]")return"object[]";if(i==="Object[][]")return"object[][]";if(i==="Blob")return"Base.Blob";{let n=ht[i];if(n)return n}let t=dt(i,e);if(t)return t;throw new Error(`${i} is not registered in package names`)},De=i=>{var a,o;let e=j(i["1"],!1),t=Z.some(c=>c.id===e),n=((a=i["2"])!=null?a:[]).map(c=>{let u=c["1"];u.includes("-")&&(u=`"${u}"`);let l=j(c["2"],!t),p=c["6"]?new k(c["6"]):void 0;return new ne(u,l,p)}),r=((o=i["3"])!=null?o:[]).map(c=>{var d;let u=Ve(c["1"]),l=j(c["2"],!t),p=((d=c["3"])!=null?d:[]).map(h=>{let C=Ve(h["1"]),w=j(h["2"],!t),B=h["6"]?new k(h["6"]):void 0;return new ne(C,w,B)}),m=c["6"]?new k(c["6"]):void 0;return new Ne(u,l,p,m)}),s=i["6"]?new k(i["6"]):void 0;return new Ee(`GoogleAppsScript.${e}`,n,r,s)},ie=async i=>{let e=await Ae.readFile(i),t=JSON.parse(e.toString()),n=new L("GoogleAppsScript"),r=De(t["1"]);n.add(r),t["2"].forEach(a=>{n.add(De(a))});let s="";return[""].includes(r.name)&&(s+=`/// <reference path="../google-apps-script.base.d.ts" />

`),s+=n.toString(0),s+=`declare const ${r.name}: GoogleAppsScript.${r.name};
`,s};var $e=S(require("fs/promises")),q=S(require("path"));T.program.name("dts-google-apps-script-advanced");T.program.command("parse <jsonFile>").action(async i=>{try{let e=await ie(i);console.log(e)}catch(e){console.error(e),process.exit(1)}});T.program.command("convert <jsonFiles...>").description("convert API definitions from json files to destination directory").option("-o, --output <outputDir>","Output directory").action(async(i,{output:e})=>{let t=i.map(async(n,r)=>{console.log(`${r+1}: Converting ${n}`);let s=q.join(e,q.basename(n,".json")+".d.ts"),a=["// Type definitions for Google Apps Script 2021-02-11","// Project: https://developers.google.com/apps-script/","// Generator: https://github.com/mtgto/dts-google-apps-script-advanced","// Definitions: https://github.com/DefinitelyTyped/DefinitelyTyped","",""].join(`
`);a+=await ie(n),await $e.writeFile(s,a)});try{await Promise.all(t)}catch(n){console.error(n),process.exit(1)}});T.program.parse();
/*!
 * word-wrap <https://github.com/jonschlinkert/word-wrap>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */
